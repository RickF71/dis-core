schema: dis-auth-handshake.v0
version: 0.9.2
description: >
  Defines the protocol for DIS-Auth handshake between two domains or agents.
  It generalizes authentication for Virtual USGOV, corporations, and 
  personal DIS identities.

fields:
  - name: handshake_id
    type: uuid
  - name: initiator
    type: dis_uid
    description: The personal DIS or domain initiating the handshake.
  - name: responder
    type: dis_uid
    description: The remote domain or system responding.
  - name: handshake_type
    type: string
    enum: [mutual, one_way, ephemeral]
  - name: scope
    type: string
    enum: [scope_0, scope_1, scope_2]
    description: >
      scope_0 = one-time or ephemeral consent ("just this once"),
      scope_1 = session-bound,
      scope_2 = persistent trust channel.
  - name: jikka_exchange
    type: object
    fields:
      - initiator_field: hash
      - responder_field: hash
      - resulting_field: hash
    description: Reflexive trust merge, forming Jikka bridge.
  - name: consent_proof
    type: hash
  - name: result_token
    type: hash
    description: Derived shared session token or capability proof.
  - name: expires_at
    type: timestamp

rules:
  - name: ephemeral_scope
    condition: scope == "scope_0"
    effect: expires_at must be <= (current_time + 1h)
  - name: persistent_scope
    condition: scope == "scope_2"
    effect: consent_proof required and must match ledger
